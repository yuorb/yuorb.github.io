import{aC as l,aD as c,aE as d,j as e,aF as p,p as g,aG as o,E as u,aH as $}from"./app-C4cpTCRC.js";class m extends l{static props={src:null,alt:null,crossOrigin:null};static state=new c({img:null,src:null,alt:null,crossOrigin:null,loading:!0,error:null,hidden:!1});#t;onSetup(){this.#t=d(),this.#n(),this.#r(),this.#o(),this.#i()}onAttach(t){t.style.setProperty("pointer-events","none"),e(this.#c.bind(this)),e(this.#n.bind(this)),e(this.#r.bind(this)),e(this.#o.bind(this)),e(this.#i.bind(this));const{started:s}=this.#t.$state;this.setAttributes({"data-visible":()=>!s()&&!this.$state.hidden(),"data-loading":this.#l.bind(this),"data-error":this.#s.bind(this),"data-hidden":this.$state.hidden})}onConnect(t){e(this.#h.bind(this)),e(this.#d.bind(this))}#s(){const{error:t}=this.$state;return!p(t())}#h(){const{canLoadPoster:t,poster:s}=this.#t.$state;!t()&&s()&&g(s(),"preconnect")}#i(){const{src:t}=this.$props,{poster:s,nativeControls:i}=this.#t.$state;this.el&&o(this.el,"display",i()?"none":null),this.$state.hidden.set(this.#s()||!(t()||s())||i())}#l(){const{loading:t,hidden:s}=this.$state;return!s()&&t()}#c(){const t=this.$state.img();t&&(new u(t).add("load",this.#a.bind(this)).add("error",this.#p.bind(this)),t.complete&&this.#a())}#e="";#n(){const{poster:t}=this.#t.$props,{canLoadPoster:s,providedPoster:i,inferredPoster:r}=this.#t.$state,n=this.$props.src()||"",a=n||t()||r();this.#e===i()&&i.set(n),this.$state.src.set(s()&&a.length?a:null),this.#e=n}#r(){const{src:t}=this.$props,{alt:s}=this.$state,{poster:i}=this.#t.$state;s.set(t()||i()?this.$props.alt():null)}#o(){const{crossOrigin:t}=this.$props,{crossOrigin:s}=this.$state,{crossOrigin:i,poster:r}=this.#t.$state,n=t()!==null?t():i();s.set(/ytimg\.com|vimeo/.test(r()||"")?null:n===!0?"anonymous":n)}#d(){const{loading:t,error:s}=this.$state,{canLoadPoster:i,poster:r}=this.#t.$state;t.set(i()&&!!r()),s.set(null)}#a(){const{loading:t,error:s}=this.$state;t.set(!1),s.set(null)}#p(t){const{loading:s,error:i}=this.$state;s.set(!1),i.set(t)}}class f extends $(HTMLElement,m){static tagName="media-poster";static attrs={crossOrigin:"crossorigin"};#t=document.createElement("img");onSetup(){this.$state.img.set(this.#t)}onConnect(){const{src:t,alt:s,crossOrigin:i}=this.$state;e(()=>{const{loading:r,hidden:n}=this.$state;this.#t.style.display=r()||n()?"none":""}),e(()=>{o(this.#t,"alt",s()),o(this.#t,"crossorigin",i()),o(this.#t,"src",t())}),this.#t.parentNode!==this&&this.prepend(this.#t)}}export{f as MediaPosterElement};
